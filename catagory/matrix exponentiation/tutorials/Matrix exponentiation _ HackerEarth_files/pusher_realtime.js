// Global pusher instance
function get_pusher_app_key(){var a=$("#pusher-app-key").text();return a}function get_pusher_auth_url(){var a=$("#pusher-auth-url").text();return a}function get_pusher_instance(){var a=$("[realtime=true]").length;if(!a)return;if(!pusher){var b=get_pusher_app_key(),c=get_pusher_auth_url();pusher=new Pusher(b,{encrypted:!1,authEndpoint:c,authTransport:"ajax"})}return pusher}function get_pusher_socket_id(){var a=get_pusher_instance();try{return a.connection.socket_id}catch(b){return""}}function get_pusher_channel_names(){var a=[],b=$("[id^=pusher-channel-name]");for(var c=0;c<b.length;c++){var d=$(b[c]).text();d&&a.push(d)}return a}function pusher_connection_established(){g_realtime_active=!0}function pusher_connection_destroyed(){g_realtime_active=!1}function channel_subscription_succeeded(){}function channel_subscription_error(a){}function message_received(a){if(typeof a!="object")return;update_html(a)}function update_html(msg){var msg_timestamp=msg.timestamp,html_el_id=msg.html_id,accepted_timedelta=msg.accepted_timedelta,message=msg.message,ntf_type=msg.ntf_type,insert_mode=msg.insert_mode,hyperlink=encodeURI(msg.hyperlink),callback=msg.callback,callback_args=msg.callback_args,locking_enabled=msg.locking,animate_enabled=msg.animate,html=message,html_el=$("#"+html_el_id),el_timestamp=html_el.attr("timestamp");typeof el_timestamp=="undefined"&&(el_timestamp=0);try{el_timestamp=parseFloat(el_timestamp),msg_timestamp=parseFloat(msg_timestamp);if(msg_timestamp<el_timestamp)return;if(accepted_timedelta!=undefined){var current_time=Date.now()/1e3;if(current_time-msg_timestamp>accepted_timedelta)return}}catch(err){return}if(html_el_id==="common-notification"){html=createNotificationDiv(message,ntf_type,hyperlink),html=html_decode(html);var new_notification=$(html);new_notification.appendTo(html_el),new_notification.delay(15e3).fadeOut(1e3)}else{html=html_decode(html);switch(insert_mode){case"append":html_el.append(html),animate_enabled&&animateUpdatedElement(html_el);break;case"insert":html_el.html(html);if(animate_enabled){var updated_el_index=html_el.children().length-1;if(updated_el_index>-1)var updated_el=html_el.children()[updated_el_index];else var updated_el=html_el;animateUpdatedElement(updated_el)}break;case"prepend":html_el.prepend(html);if(animate_enabled){var updated_el=html_el.children()[0];animateUpdatedElement(updated_el)}break;case"delete":html_el.empty();break;case"replace":html_el.replaceWith(html),animate_enabled&&animateUpdateElement(html_el);break;case"idle":}}html_el.attr("timestamp",msg_timestamp);if(insert_mode=="insert"){var scripts=html_el.find("script"),len=scripts.length;for(var i=0;i<len;++i){var script=scripts[i],scriptEl=$(script);eval(scriptEl.text())}}if(callback)try{window[callback].apply(this,callback_args)}catch(e){}}function animateUpdatedElement(a){var b=700;$(a).hide().fadeIn(b)}function createNotificationDiv(a,b,c){var d="",e="<div class='notification-close'><i class='fa fa-times fa-lg lighter' aria-hidden='true'></i></div>",f="<div class='"+d+" notification-container dark'>"+a+e+"</div>";return c&&(d+=" pointer",f="<div class='"+d+" notification-container'>"+a+e+"<a class='notification-link' href='"+c+"' target='_blank'></a></div>"),f}function html_decode(a){var b=document.createElement("textarea");return b.innerHTML=a,b.value}function makeid(){var a="",b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var c=0;c<5;c++)a+=b.charAt(Math.floor(Math.random()*b.length));return a}function spawnNotification(a,b,c){var d={body:b,icon:"https://hackerearth.global.ssl.fastly.net/static/hackerearth/images/logo/HE_identity.png"};if("hidden"in document&&document.hidden){var e=new Notification(a,d);c&&(e.onclick=function(){window.location.href=c})}}var pusher=null,g_realtime_active=!1;$(document).ready(function(){var a=get_pusher_instance();if(!a)return;a.connection.bind("connected",pusher_connection_established),a.connection.bind("unavailable",pusher_connection_destroyed),a.connection.bind("failed",pusher_connection_destroyed),a.connection.bind("disconnected",pusher_connection_destroyed);var b=get_pusher_channel_names();for(var c=0;c<b.length;c++){var d=b[c],e=a.channel(d);if(!!e)continue;e=a.subscribe(d),e.bind("pusher:subscription_succeeded",channel_subscription_succeeded),e.bind("pusher:subscription_error",channel_subscription_error),e.bind("html_updated",message_received)}});var eventStartNotification=function(a,b,c){"Notification"in window?Notification.permission==="granted"?spawnNotification(a,b,c):Notification.permission!=="denied"&&Notification.requestPermission(function(d){if(d!=="granted")return;spawnNotification(a,b,c)}):console.log("Seems like your browser is outdated, please update your browser.")},requestDesktopNotificationPermission=function(a){Notification.permission!="granted"&&Notification.requestPermission().then(function(b){var c="Kudos! We will notify you when Challenge starts.",d="Make sure you've enabled web notifications in your HackerEarth profile settings.";spawnNotification(c,d,a)})};